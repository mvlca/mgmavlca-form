(()=>{document.addEventListener("DOMContentLoaded",()=>{let r=[];document.getElementById("factories-search").addEventListener("input",o=>{let e=o.target.value.toLowerCase();r.forEach(c=>{let n=c.FName.toLowerCase().includes(e)||c.COwner.toLowerCase().includes(e);c.element.classList.toggle("factories-hidden",!n)});let t=r.filter(c=>!c.element.classList.contains("factories-hidden")).length;s.textContent=t});let l="AKfycbxNBipzRe0emt7-6qMV1nxzWLcAzbn61VMhJXqaqqDgEab0tUIgbqrqIfij7WBWwfAv",s=document.getElementById("factories-count"),i=document.getElementById("factories-block"),d=document.getElementById("factories-template");function m(){let o=`https://script.google.com/macros/s/${l}/exec?sheet=2025Overview4`;s.textContent="...",i.innerHTML="Please wait. Loading ...",fetch(o).then(e=>e.json()).then(e=>{i.innerHTML="",s.textContent=e.length,r=e.map(t=>{let n=d.content.cloneNode(!0).querySelector(".each-factory-block");return n.querySelector(".each-factory-name").textContent=t.FName,n.querySelector(".each-factory-type").textContent=t.COwner,n.querySelector(".each-factory-workers").textContent=t.Workers,n.querySelector(".each-factory-position").textContent=t.Position,n.querySelector(".each-factory-timestamp").textContent=t.Timestamp,i.appendChild(n),{FName:t.FName||"",COwner:t.COwner||"",element:n}})}).catch(e=>{i.innerHTML="Error loading data.",s.textContent="Error",console.error("Fetch error:",e)})}m();let a=document.querySelector(".factories-search-form");a.addEventListener("reset",()=>{document.getElementById("factories-search").value="",r.forEach(o=>{o.element.classList.remove("factories-hidden")}),s.textContent=r.length}),a.addEventListener("submit",o=>{o.preventDefault()})});})();
